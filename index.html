<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DACEW | Service technologique</title>
    <link href="assets/css/style.css" rel="stylesheet" >
    <style>
    </style>
</head>
<body>
    <!-- Barre de navigation -->
    <div class="navbar">
        <a href="#" class="logo">
            <img src="assets/images/Logo-invis bckgr zoom.png" alt="DACEW">
        </a>
        <div class="search-bar">
            <input type="text" placeholder="Rechercher un produit">
            <button>🔍</button>
        </div>
        <div class="language-selector">
            <button class="language-btn">🌐 FR ▼</button>
            <div class="language-dropdown">
                <a href="#">Français</a>
                <a href="#">English</a>
                <a href="#">Español</a>
                <a href="#">Deutsch</a>
                <a href="#">Italiano</a>
            </div>
        </div>
        <div class="nav-links">
            <div>
                <div class="nav-link">Bonjour, Identifiez-vous</div>
                <div class="nav-link"><strong>Compte et listes</strong></div>
            </div>
            <div>
                <div class="nav-link">Retours</div>
                <div class="nav-link"><strong>et commandes</strong></div>
            </div>
            <div class="nav-link">🛒 Panier</div>
        </div>
    </div>
    
    <!-- Barre des catégories -->
    <div class="categories">
        <a href="#" class="category">Toutes nos catégories</a>
        <a href="#" class="category">Meilleures Ventes</a>
        <a href="#" class="category">Rabais</a>
        <a href="#" class="category">Dernières Nouveautés</a>
        <a href="#" class="category">Service Client</a>
    </div>
    
    <!-- Bannière -->
    <div class="banner">
        <img src="assets/images/bannierePromo.png" alt="Bannière promotionnelle">
    </div>
    
    <!-- Contenu principal avec filtres et produits -->
    <div class="content-wrapper">
        <!-- Filtres -->
        <div class="filters">
            <div class="filter-section">
                <div class="filter-title">Catégories</div>
                <div class="filter-option">
                    <input type="checkbox" id="cat-electronics">
                    <label for="cat-electronics">Électronique</label>
                </div>
                <div class="filter-option">
                    <input type="checkbox" id="cat-computer">
                    <label for="cat-computer">Informatique</label>
                </div>
                <div class="filter-option">
                    <input type="checkbox" id="cat-audio">
                    <label for="cat-audio">Audio</label>
                </div>
                <div class="filter-option">
                    <input type="checkbox" id="cat-wearable">
                    <label for="cat-wearable">Objets connectés</label>
                </div>
            </div>
            
            <div class="filter-section">
                <div class="filter-title">Prix</div>
                <div class="filter-option">
                    <input type="range" min="0" max="500" value="250" class="price-slider" id="price-range">
                    <div>0$ - <span id="price-value">250</span>$</div>
                </div>
            </div>
            
            <div class="filter-section">
                <div class="filter-title">Évaluation</div>
                <div class="filter-option">
                    <input type="checkbox" id="rating-4">
                    <label for="rating-4">★★★★☆ et plus</label>
                </div>
                <div class="filter-option">
                    <input type="checkbox" id="rating-3">
                    <label for="rating-3">★★★☆☆ et plus</label>
                </div>
                <div class="filter-option">
                    <input type="checkbox" id="rating-2">
                    <label for="rating-2">★★☆☆☆ et plus</label>
                </div>
            </div>
            
            <div class="filter-section">
                <div class="filter-title">Marque</div>
                <div class="filter-option">
                    <input type="checkbox" id="brand-apple">
                    <label for="brand-apple">Adidas</label>
                </div>
                <div class="filter-option">
                    <input type="checkbox" id="brand-samsung">
                    <label for="brand-samsung">Nike</label>
                </div>
                <div class="filter-option">
                    <input type="checkbox" id="brand-sony">
                    <label for="brand-sony">Puma</label>
                </div>
                <div class="filter-option">
                    <input type="checkbox" id="brand-bose">
                    <label for="brand-bose">Champions</label>
                </div>
            </div>
            
            <button class="product-button", onclick="filterPrice()">Appliquer les filtres</button>
        </div>
        
        <!-- Section des produits -->
        <div class="products">
            <!-- Produit 1 -->
            <div class="product-card" style="display: block;">
                <div class="product-image">
                    <img src="assets/images/logoFondBlanc.png" alt="Produit 1">
                </div>
                <div class="product-title">Produit 1</div>
                <div class="product-price">99,99 $</div>
                <div class="product-rating">★☆☆☆☆ (2 456)</div>
                <button class="product-button">Ajouter au panier</button>
            </div>
            
            <!-- Produit 2 -->
            <div class="product-card" style="display: block;">
                <div class="product-image">
                    <img src="assets/images/logoFondBlanc.png" alt="Produit 2">
                </div>
                <div class="product-title">Produit 2</div>
                <div class="product-price">129,99 $</div>
                <div class="product-rating">★★☆☆☆ (3 827)</div>
                <button class="product-button">Ajouter au panier</button>
            </div>
            
            <!-- Produit 3 -->
            <div class="product-card" style="display: block;">
                <div class="product-image">
                    <img src="assets/images/logoFondBlanc.png" alt="Produit 3">
                </div>
                <div class="product-title">Produit 3</div>
                <div class="product-price">59,99 $</div>
                <div class="product-rating">★★★★★ (1 874)</div>
                <button class="product-button">Ajouter au panier</button>
            </div>
            
            <!-- Produit 4 -->
            <div class="product-card" style="display: block;">
                <div class="product-image">
                    <img src="assets/images/logoFondBlanc.png" alt="Produit 4">
                </div>
                <div class="product-title">Produit 4</div>
                <div class="product-price">249,99 $</div>
                <div class="product-rating">★★★★☆ (11k)</div>
                <button class="product-button">Ajouter au panier</button>
            </div>

            <!-- Produit 5 -->
            <div class="product-card" style="display: block;">
                <div class="product-image">
                    <img src="assets/images/logoFondBlanc.png" alt="Produit 5">
                </div>
                <div class="product-title">Produit 5</div>
                <div class="product-price">259,99 $</div>
                <div class="product-rating">★★☆☆☆ (11k)</div>
                <button class="product-button">Ajouter au panier</button>
            </div>

            <!-- Produit 6 -->
            <div class="product-card" style="display: block;">
                <div class="product-image">
                    <img src="assets/images/logoFondBlanc.png" alt="Produit 6">
                </div>
                <div class="product-title">Produit 6</div>
                <div class="product-price">269,99 $</div>
                <div class="product-rating">★★★★☆ (17k)</div>
                <button class="product-button">Ajouter au panier</button>
            </div>

            <!-- Produit 7 -->
            <div class="product-card" style="display: block;">
                <div class="product-image">
                    <img src="assets/images/logoFondBlanc.png" alt="Produit 7">
                </div>
                <div class="product-title">Produit 7</div>
                <div class="product-price">289,99 $</div>
                <div class="product-rating">★★★☆☆ (71k)</div>
                <button class="product-button">Ajouter au panier</button>
            </div>

            <!-- Produit 8 -->
            <div class="product-card" style="display: block;">
                <div class="product-image">
                    <img src="assets/images/logoFondBlanc.png" alt="Produit 8">
                </div>
                <div class="product-title">Produit 8</div>
                <div class="product-price">309,99 $</div>
                <div class="product-rating">★★★★☆ (2k)</div>
                <button class="product-button">Ajouter au panier</button>
            </div>

        </div>
    </div>
    
    <!-- Section carte -->
    <div class="map-section" style="position: relative;">
        <div class="map-title">Localiser les points de livraison près de chez vous</div>
        <div class="map-container" style="position: relative; height: 500px;">
            <div class="map-overlay" style="position: absolute; z-index: 1000; background: rgba(255,255,255,0.9); padding: 10px; margin: 10px; border-radius: 8px;">
                <div>Entrez votre adresse pour trouver les points de livraison</div>
                <input type="text" id="address-input" placeholder="Votre adresse..." style="width: 100%; padding: 5px; margin-top: 5px;">
                <div class="map-controls" style="margin-top: 10px;">
                    <button class="map-btn" onclick="searchAddress()">Rechercher</button>
                    <button class="map-btn" onclick="locateUser()">Utiliser ma position</button>
                </div>
            </div>
    
            <!-- Emplacement pour la carte -->
            <div id="map" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;"></div>
        </div>
    
        <!-- Section for displaying distances -->
        <div id="distance-info" style="position: absolute; top: 10px; right: 10px; background: rgba(255, 255, 255, 0.7); padding: 5px; border-radius: 5px;">
            <!-- Distance details will be displayed here -->
        </div>
    </div>
    
    <!-- Include Leaflet CSS and JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Leaflet Map Initialization -->
    <script>
        let currentMarker = null; // Replace both previousMarker and selectedMarker
        let polyline = null;
        let routeLayer = null;
    
        const deliveryPoint = [45.5019, -73.5674];
        const map = L.map('map').setView(deliveryPoint, 13);
    
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);
    
        L.marker(deliveryPoint).addTo(map)
            .bindPopup('Point de livraison - Montréal')
            .openPopup();
    
        function clearMapElements() {
            if (currentMarker) map.removeLayer(currentMarker);
            if (polyline) map.removeLayer(polyline);
            if (routeLayer) map.removeLayer(routeLayer);
        }
    
        function locateUser() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const userLatLng = [position.coords.latitude, position.coords.longitude];
                    map.setView(userLatLng, 14);
                    clearMapElements();
                    currentMarker = L.marker(userLatLng).addTo(map).bindPopup("Vous êtes ici").openPopup();
                    drawRouteAndLine(userLatLng);
                }, () => {
                    alert("Impossible de récupérer votre position.");
                });
            } else {
                alert("La géolocalisation n'est pas supportée par ce navigateur.");
            }
        }
    
        function searchAddress() {
            const address = document.getElementById('address-input').value;
            if (!address) {
                alert("Veuillez entrer une adresse.");
                return;
            }
    
            const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`;
    
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.length === 0) {
                        alert("Adresse introuvable.");
                        return;
                    }
    
                    const lat = parseFloat(data[0].lat);
                    const lon = parseFloat(data[0].lon);
                    const newLatLng = [lat, lon];
    
                    map.setView(newLatLng, 14);
                    clearMapElements();
                    currentMarker = L.marker(newLatLng).addTo(map).bindPopup(data[0].display_name).openPopup();
                    drawRouteAndLine(newLatLng);
                })
                .catch(error => {
                    alert("Erreur lors de la recherche.");
                    console.error(error);
                });
        }
    
        function drawRouteAndLine(destination) {
            // Red dashed line
            polyline = L.polyline([deliveryPoint, destination], {
                color: 'red',
                weight: 2,
                dashArray: '5, 5'
            }).addTo(map);
    
            // Route
            calculateRoute(deliveryPoint, destination);
            calculateDistance(deliveryPoint, destination);
        }
    
        function calculateRoute(start, end) {
            const routeUrl = `https://router.project-osrm.org/route/v1/driving/${start[1]},${start[0]};${end[1]},${end[0]}?overview=full&geometries=geojson`;
    
            fetch(routeUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.routes && data.routes.length > 0) {
                        const route = data.routes[0].geometry;
    
                        routeLayer = L.geoJSON(route, {
                            style: { color: 'blue', weight: 4 }
                        }).addTo(map);
    
                        const routeDistance = data.routes[0].legs[0].distance / 1000;
                        displayDistance(routeDistance);
                    } else {
                        alert("Aucun itinéraire trouvé.");
                    }
                })
                .catch(error => {
                    alert("Erreur lors du calcul de l'itinéraire.");
                    console.error(error);
                });
        }
    
        function calculateDistance(start, end) {
            const R = 6371;
            const dLat = (end[0] - start[0]) * Math.PI / 180;
            const dLon = (end[1] - start[1]) * Math.PI / 180;
            const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                      Math.cos(start[0] * Math.PI / 180) * Math.cos(end[0] * Math.PI / 180) *
                      Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            const distance = R * c;
    
            displayDistance(distance);
        }
    
        function displayDistance(distance) {
            document.getElementById('distance-info').innerHTML = `La distance entre les deux points est de ${distance.toFixed(2)} km.`;
        }
    
        // Reverse geocode map click
        map.on('click', function(e) {
            const newLatLng = [e.latlng.lat, e.latlng.lng];
            clearMapElements();
    
            const reverseUrl = `https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${newLatLng[0]}&lon=${newLatLng[1]}`;
    
            fetch(reverseUrl)
                .then(response => response.json())
                .then(data => {
                    const address = data.display_name || `${newLatLng[0].toFixed(4)}, ${newLatLng[1].toFixed(4)}`;
                    currentMarker = L.marker(newLatLng).addTo(map)
                        .bindPopup(`Adresse sélectionnée : ${address}`)
                        .openPopup();
                    drawRouteAndLine(newLatLng);
                })
                .catch(error => {
                    console.error("Erreur reverse geocoding:", error);
                    currentMarker = L.marker(newLatLng).addTo(map)
                        .bindPopup(`Coordonnées : ${newLatLng[0].toFixed(4)}, ${newLatLng[1].toFixed(4)}`)
                        .openPopup();
                    drawRouteAndLine(newLatLng);
                });
        });
    </script>
    
    <!-- Pied de page -->
    <div class="footer">
        <div class="footer-links">
            <a href="#" class="footer-link">Conditions d'utilisation</a>
            <a href="#" class="footer-link">Protection de vos informations personnelles</a>
            <a href="#" class="footer-link">Aide</a>
            <a href="#" class="footer-link">Vos commentaires</a>
        </div>
        <div>© 2025, DACEW.com</div>
    </div>

<script src="assets/js/script.js"></script>

</body>
</html>